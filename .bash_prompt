#!/bin/bash  ╱  ╱  ╱ ╱ ╱
# ╱ ╱ ╱ ╱  A   ╱ ╱ ╱ ╱ ╱
# ╱┳┳╮╭╮┳╮╱╭╮┳╭╮╱ ╱ ╱
# ╱┃┃┃┣┫┣┻╮┃╱┃┃┃╱ ╱ ╱ ╱ ╱
# ╱┛┛┛┻┗┻╱┗╰╯┻╰╯╱ ╱ ╱
# ╱┳┳╭┛┳┓┳┳╮╭╮┏┳┓╭╮┳╭┛
# ╱┃┣┻╮┣╱┃┃┃┣┫╱┃╱╰╮┃┃
# ╱┻┗╱┗┗┛┛┛┛┛┗╱┻╱╰╯╰┻
# ╱ ╱ ╱ ╱ ╱ ╱ ╱ DOTFILE ♡ ╱
# ╱ ╱ ╱ ╱ ╱ ╱ ╱  ╱ ╱ ╱
# ╱ ╱ ╱ ╱ ╱ ╱ ╱
# ╱ ╱ ╱ ╱ ╱ ╱ ╱
# ╱ ╱ ╱ ╱ ╱
# ╱ ╱ ╱                      marcio.ikematsu@usp.br
# ╱

#################
### VARIABLES ###
#################

TERM=xterm-256color
PINK="$(tput setaf 198)"
RED="$(tput setaf 9)"
ORANGE="$(tput setaf 214)"
LIME="$(tput setaf 154)"
GREEN="$(tput setaf 118)"
CYAN="$(tput setaf 39)"
YELLOW=$(tput setaf 220)
LIGHT_BLUE="$(tput setaf 45)"
MEDIUM_BLUE="$(tput setaf 39)"
DARK_BLUE="$(tput setaf 33)"
PURPLE="$(tput setaf 135)"
GREY="$(tput setaf 248)"
RESET="$(tput sgr0)"

#############################
### 3rd PARTY STUFF SETUP ###
#############################

# virtualenvwrapper settings
if [ -e /usr/local/bin/virtualenvwrapper.sh ]; then
  export WORKON_HOME=$HOME/.virtualenvs #virtual environments folder
  export PROJECT_HOME=$HOME/Projects/web/ # projects folder
  source /usr/local/bin/virtualenvwrapper.sh #location of the script TODO: add this to dotfile
  # export VIRTUAL_ENV_DISABLE_PROMPT=1 # disables virtualenv in the prompt
fi


#################
### MY PROMPT ###
#################
# theme: blue sky
# COLOR_0="${LIME}"
# COLOR_1="${GREEN}"
# COLOR_2="${LIGHT_BLUE}"
# COLOR_3="${MEDIUM_BLUE}"
# COLOR_4="${DARK_BLUE}"

# theme: warm sky
# COLOR_5=""
# COLOR_0=$PINK
# COLOR_1=$(tput setaf 202)
# COLOR_2=$(tput setaf 208)
# COLOR_3=$(tput setaf 214)
# COLOR_4=$(tput setaf 220)

# theme: 80's space age
COLOR_0=""
COLOR_1=$DARK_BLUE
COLOR_2=$MEDIUM_BLUE
COLOR_3=$(tput setaf 165)
COLOR_4=$(tput setaf 207)
COLOR_5=""

# structure elements
VENV_PS1="${COLOR_0}"
VENV_SYMBOL_PS1="● "
USER_PS1="${COLOR_1}\u${RESET}"
#HOST_PS1="${COLOR_2}\h${RESET}"
HOST_PS1="${COLOR_2}$(scutil --get LocalHostName)${PLUS}${RESET}"
PATH_PS1="${COLOR_3}\w${RESET}"
# git prompt
if [ -e ~/.git-prompt.sh ]; then
  source ~/.git-prompt.sh #loads git-prompt
  GIT_PS1_HIDE_IF_PWD_IGNORED=true #do nothing if dir is .gitignored
  GIT_PS1_STATESEPARATOR="${RESET} ${COLOR_5}"
  GIT_PS1_SHOWUNTRACKEDFILES=true
  GIT_PS1_SHOWDIRTYSTATE=true
  GIT_PS1_SHOWUPSTREAM="git"
  GIT_PS1_DESCRIBE_STYLE="contains"
  #GIT_PS1_SHOWCOLORHINTS=true
  gitPrompt() {
      case $(__git_ps1) in
          *"%>"*) #untracked
            echo $(__git_ps1 "on ${COLOR_4}%s") | sed 's/\|.*/ frente untraco/';;
          *"%"*)    echo $(__git_ps1 "on ${COLOR_4}%s") | sed 's/\|.*/ untraco/';; # dirty
          *"<>"*)   echo $(__git_ps1 "on ${COLOR_4}%s") | sed 's/\|.*/ briguinha/';; # stream diverged
          *"="*)    echo $(__git_ps1 "on ${COLOR_4}%s") | sed 's/\|.*/ tamoai/';; # normal
          *"<"*)    echo $(__git_ps1 "on ${COLOR_4}%s") | sed 's/\|.*/ volta/';;
          *'>'*)    echo $(__git_ps1 "on ${COLOR_4}%s") | sed 's/\|.*/ frenta/';; # ahed stream
      esac
  }

  dirty() {
    if [[ $1 == *"%"* ]]; then true; fi
  }

  #GITPROMPT_PS1='$(gitPrompt)'
  GITPROMPT_PS1='$(__git_ps1 "on ${COLOR_4}%s${RESET}")'
fi

#http://www.fileformat.info/info/unicode/block/geometric_shapes/list.htm
PROMPT_SYMBOL_PS1="\n↪ " # ✂ ☎ ☏ ☕ ☞ ☛ | ☠ ☭ ♂ ⚡ ϟ | ♘ ♞ | ♖ ♜ | ♔ ♚ | ♕ ♛ | ♙ ♟ | ♫ ♻ ♺ ⚓ ✎ ✏ ✐ ✑ ↪ ▸ ▹ ► ▻ Ⓧ ⎈ ⧔ ⧕ ⧫ ⬤ ●

# this var executes a command before bash display the prompt
#PROMPT_COMMAND="echo -n [$(date +%H%M)]"

PS1="$USER_PS1 at $HOST_PS1 in $PATH_PS1 $GITPROMPT_PS1 $PROMPT_SYMBOL_PS1"
